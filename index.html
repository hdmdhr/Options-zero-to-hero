<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœŸæƒé›¶åŸºç¡€ï¼šä»å°ç™½åˆ°ç”šè‡³ä¸æƒ³ä¹°æ­£è‚¡ - ç¬¬ä¸€é›†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <!-- Marked library for parsing Markdown in chat responses -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Chosen Palette: "Neon FinTech" (Vibrant/Energetic)
         Primary: Indigo-600 (#4F46E5)
         Secondary: Pink-500 (#EC4899)
         Accent: Cyan-500 (#06B6D4)
         Bg: Gray-100 (#F3F4F6)
    -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&family=Roboto:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans SC', 'Noto Sans JP', 'Roboto', sans-serif;
            background-color: #F3F4F6;
            color: #1F2937;
        }

        /* Chart Container Styling - MANDATORY Requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 650px; /* Max width constraint */
            margin-left: auto;
            margin-right: auto; /* Horizontally centered */
            height: 350px; /* Default height */
            max-height: 400px; /* Max height constraint */
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        /* Custom Card Styling */
        .info-card {
            background-color: white;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
            border-top: 4px solid #4F46E5; /* Indigo accent */
            transition: transform 0.2s;
        }
        .info-card:hover {
            transform: translateY(-2px);
        }

        /* Chat Widget Styling */
        .chat-widget {
            transition: all 0.3s ease-in-out;
        }
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }
        .chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .chat-messages::-webkit-scrollbar-thumb {
            background: #c7c7c7;
            border-radius: 3px;
        }
        
        /* Markdown Content Styling within Chat */
        .prose p { margin-bottom: 0.5em; }
        .prose ul { list-style-type: disc; margin-left: 1.2em; margin-bottom: 0.5em; }
        .prose strong { color: #4F46E5; }

        /* Modal Styling */
        .modal {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal.open {
            opacity: 1;
            pointer-events: auto;
        }
        .modal.open .modal-content {
            transform: scale(1);
        }

        /* Quiz Styling */
        .option-btn {
            transition: all 0.2s;
        }
        .option-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="antialiased pb-20">

    <!-- Navigation / Header -->
    <header class="bg-indigo-700 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold flex items-center gap-2">
                    <span data-i18n="headerTitle">æœŸæƒé›¶åŸºç¡€</span>
                    <span class="text-xs bg-pink-500 px-2 py-0.5 rounded-full" data-i18n="headerBadge">AI å¢å¼ºç‰ˆ</span>
                </h1>
                <p class="text-sm text-indigo-200" data-i18n="headerSubtitle">Episode 1: ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å­¦æœŸæƒï¼Ÿ</p>
            </div>
            <div class="flex items-center gap-4">
                <div class="hidden md:block text-sm font-semibold bg-indigo-800 px-3 py-1 rounded">
                    From Zero to Hero
                </div>
                <!-- Settings Button -->
                <button id="settingsBtn" class="text-white hover:text-pink-300 transition-colors p-2" title="API Key Settings">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                </button>
                <!-- Language Selector -->
                <select id="languageSelector" class="bg-indigo-600 text-white border border-indigo-400 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-pink-500">
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                </select>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 space-y-12">

        <!-- SECTION 1: THE HOOK -->
        <section id="intro" class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
            <div class="order-2 md:order-1">
                <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-pink-500">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4" data-i18n="introTitle">æ„Ÿæ©èŠ‚æŠ•æœºï¼šåƒå‡ºæ¥çš„æœºä¼šï¼Ÿ</h2>
                    <p class="text-gray-600 mb-4 leading-relaxed" data-i18n="introText">
                        æ•…äº‹ä»ä¸€ä¸ªç®€å•çš„é€»è¾‘å¼€å§‹ï¼šæ„Ÿæ©èŠ‚å¤§å®¶åƒå¤ªå¤š -> èŠ‚åæƒ³è¦å‡è‚¥ -> å¥èº«æˆ¿ç”Ÿæ„ç«çˆ†ã€‚
                        è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåå°”è¡—ç›¯ä¸Šäº† <strong>Planet Fitness (æ˜Ÿçƒå¥èº«)</strong>ã€‚ä½†ä¸å…¶ç›´æ¥ä¹°è‚¡ç¥¨ï¼Œä¸“å®¶æ¨èäº†ä¸€ä¸ªåå­—é•¿åˆ°è®©äººçª’æ¯çš„ç­–ç•¥...
                    </p>
                    <div class="bg-indigo-50 p-4 rounded-lg">
                        <p class="font-bold text-indigo-700 text-lg">"Bull Call Spread Risk Reversal"</p>
                        <p class="text-xs text-indigo-500 mt-1" data-i18n="introStrategyNote">ï¼ˆä¸­æ–‡åï¼šç‰›å¸‚ä»·å·®é£é™©é€†è½¬ç­–ç•¥ â€”â€” åå­—æ˜¯ä¸æ˜¯å¾ˆé•¿ï¼Ÿï¼‰</p>
                    </div>
                </div>
            </div>
            <div class="order-1 md:order-2 flex flex-col items-center">
                <div class="chart-container">
                    <canvas id="caloriesChart"></canvas>
                </div>
                <p class="text-sm text-gray-500 mt-2 text-center" data-i18n="introChartCaption">3000å¤§å¡/é¡¿çš„æ™šé¤å¼•å‘çš„æŠ•èµ„è´è¶æ•ˆåº”</p>
            </div>
        </section>

        <!-- SECTION 2: BACK TO BASICS - CALL OPTION -->
        <section id="call-option" class="bg-white rounded-2xl shadow-lg p-8">
            <div class="mb-6 border-b pb-4">
                <h2 class="text-3xl font-bold text-indigo-700 flex items-center gap-2">
                    <span class="text-4xl">ğŸ </span> <span data-i18n="callTitle">Call (è®¤è´­æœŸæƒ)</span>
                </h2>
                <p class="text-gray-500 mt-2" data-i18n="callSubtitle">æ ¸å¿ƒé€»è¾‘ï¼šäº¤å®šé‡‘ï¼Œé”ä»·æ ¼ (Buy Low, Sell High)</p>
            </div>

            <!-- CONTRACT SIZE NOTE -->
            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-8">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm text-yellow-700 font-bold" data-i18n="contractNote">
                            çŸ¥è¯†ç‚¹ï¼š1 å¼ æœŸæƒåˆçº¦ = 100 è‚¡è‚¡ç¥¨ã€‚
                            <span class="font-normal">ï¼ˆä¸‹æ–‡ä¸ºæ–¹ä¾¿ç†è§£ï¼Œä»·æ ¼å‡ä¸ºâ€œå•è‚¡â€ä»·æ ¼ï¼Œå®é™…äº¤æ˜“éœ€ x100ï¼‰</span>
                        </p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-bold text-gray-800 mb-3" data-i18n="callAnalogyTitle">ç±»æ¯”ï¼šä¹°æˆ¿å®šé‡‘</h3>
                    <p class="text-gray-600 mb-4 leading-relaxed" data-i18n="callAnalogyText">
                        æƒ³è±¡ä½ çœ‹ä¸­ä¸€å¥—100ä¸‡çš„æˆ¿å­ã€‚ä½ æ”¯ä»˜äº† <strong>1ä¸‡å…ƒå®šé‡‘ (æƒåˆ©é‡‘)</strong>ï¼Œé”å®šäº†ä¸‹ä¸ªæœˆç”¨100ä¸‡ä¹°æˆ¿çš„æƒåˆ©ã€‚
                    </p>
                    <ul class="space-y-2 mb-6 text-sm">
                        <li class="flex items-center gap-2">
                            <span class="text-green-500 font-bold">âœ”</span>
                            <span data-i18n="callScenarioWin"><strong>è‹¥æˆ¿ä»·æ¶¨åˆ°120ä¸‡ï¼š</strong> ä½ æŒ‰100ä¸‡ä¹°å…¥ï¼Œè½¬æ‰‹å–å‡ºèµš20ä¸‡ã€‚å›æŠ¥ç‡ 2000%ï¼</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <span class="text-red-500 font-bold">âœ˜</span>
                            <span data-i18n="callScenarioLose"><strong>è‹¥æˆ¿ä»·è·Œåˆ°80ä¸‡ï¼š</strong> ä½ æ”¾å¼ƒå®šé‡‘ï¼ŒåªæŸå¤±1ä¸‡ã€‚æˆ¿å­ä¸è¦äº†ã€‚</span>
                        </li>
                    </ul>
                    <div class="bg-blue-50 p-4 rounded border border-blue-200">
                        <h4 class="font-bold text-blue-800" data-i18n="callExampleTitle">è‚¡å¸‚å®ä¾‹ï¼šè‹±ä¼Ÿè¾¾ (NVDA)</h4>
                        <p class="text-sm text-blue-700 mt-1" data-i18n="callExampleText">
                            è‚¡ä»· $100ã€‚ä½ èŠ± $5 ä¹°å…¥ Call (è¡Œæƒä»· $100)ã€‚<br>
                            å¦‚æœæ¶¨åˆ° $150ï¼Œä½ èµš $45 ($150 - $100 - $5)ã€‚<br>
                            ç¿»äº†9å€ï¼è¿™å°±æ˜¯<strong>ä»¥å°åšå¤§</strong>ã€‚
                        </p>
                    </div>
                </div>
                <div class="flex flex-col justify-center">
                    <div class="chart-container">
                        <canvas id="callPayoffChart"></canvas>
                    </div>
                    <p class="text-xs text-gray-400 text-center mt-2" data-i18n="callChartCaption">Call Option æŸç›Šæ›²çº¿ï¼šé£é™©æœ‰é™ï¼Œæ”¶ç›Šæ— é™</p>
                </div>
            </div>
        </section>

        <!-- SECTION 3: BACK TO BASICS - PUT OPTION -->
        <section id="put-option" class="bg-white rounded-2xl shadow-lg p-8 border-t-4 border-pink-500">
            <div class="mb-6 border-b pb-4">
                <h2 class="text-3xl font-bold text-pink-600 flex items-center gap-2">
                    <span class="text-4xl">ğŸš—</span> <span data-i18n="putTitle">Put (è®¤æ²½æœŸæƒ)</span>
                </h2>
                <p class="text-gray-500 mt-2" data-i18n="putSubtitle">æ ¸å¿ƒé€»è¾‘ï¼šä¹°ä¿é™©ï¼Œé˜²ç¾å®³ (Hedging / Protection)</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="order-2 md:order-1 chart-container">
                    <canvas id="putProtectionChart"></canvas>
                </div>
                <div class="order-1 md:order-2">
                    <h3 class="text-xl font-bold text-gray-800 mb-3" data-i18n="putAnalogyTitle">ç±»æ¯”ï¼šè½¦é™©</h3>
                    <p class="text-gray-600 mb-4 leading-relaxed" data-i18n="putAnalogyText">
                        æƒ³è±¡ä½ åˆšä¹°äº†ä¸€è¾†ç‰¹æ–¯æ‹‰ Model Y (ä»·å€¼ $5ä¸‡)ã€‚ä½ æ€•æ’è½¦å½’é›¶ï¼Œäºæ˜¯èŠ± $1000 ä¹°ä¿é™© (Put)ã€‚<br>
                        <strong>ä¿é™©æ¡æ¬¾ (è¡Œæƒä»· $5ä¸‡)ï¼š</strong><br>
                        å¦‚æœè½¦å­å…¨æŸ (ä»·å€¼å½’ 0)ï¼Œä¿é™©å…¬å¸èµ”ä½  $5ä¸‡ã€‚
                    </p>
                    <div class="bg-pink-50 p-4 rounded border border-pink-200">
                        <p class="text-sm text-pink-800" data-i18n="putActionText">
                            <strong>åœ¨è‚¡å¸‚é‡Œï¼š</strong><br>
                            ä½ æŒæœ‰è‚¡ç¥¨ (Model Y)ï¼Œä¹°å…¥ Put (è½¦é™©)ã€‚<br>
                            å³ä½¿å…¬å¸å€’é—­ (è‚¡ä»·å½’0)ï¼Œä½ æœ‰æƒæŒ‰ <strong>$5ä¸‡ (è¡Œæƒä»·)</strong> æŠŠåºŸçº¸å–ç»™ä¿é™©å…¬å¸ã€‚<br>
                            ä½ çš„æœ€å¤§æŸå¤±ä»…ä¸º $1000 (ä¿è´¹)ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: THE BUFFETT MINDSET - SELLING PUTS -->
        <section id="sell-put" class="bg-gray-800 text-white rounded-2xl shadow-xl p-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div>
                    <h2 class="text-3xl font-bold text-cyan-400 mb-4" data-i18n="sellPutTitle">ä¸ºä»€ä¹ˆè¦åšâ€œä¿é™©å…¬å¸â€ (Sell Put)?</h2>
                    <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-i18n="sellPutIntro">
                        å¯¹æ•£æˆ·æ¥è¯´ï¼Œå–ä¿é™©å¬èµ·æ¥å¾ˆç–¯ç‹‚ã€‚ä½†å¯¹å·´è²ç‰¹æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ç¬”å®Œç¾çš„ç”Ÿæ„ï¼š
                    </p>
                    <div class="bg-gray-700 p-6 rounded-lg mb-6 border-l-4 border-cyan-400">
                        <p class="italic text-lg" data-i18n="sellPutQuote">
                            "æˆ‘æƒ³ä¹°è¿™åªè‚¡ç¥¨ï¼Œä½†ç°åœ¨çš„ä»·æ ¼($100)å¤ªè´µã€‚å¦‚æœè·Œåˆ° $90ï¼Œæˆ‘æ„¿æ„å…¨ä»“æ¥ç›˜ã€‚"
                        </p>
                    </div>
                    <div class="space-y-4 text-gray-300" data-i18n="sellPutLogic">
                        <p><strong>æ“ä½œï¼š</strong> å–å‡º $90 çš„ Putï¼Œæ”¶å…¥ $2 æƒåˆ©é‡‘ã€‚</p>
                        <ul class="list-disc pl-5 space-y-2">
                            <li><strong>åœºæ™¯ A (ä¸è·Œ)ï¼š</strong> è‚¡ä»·ä¿æŒåœ¨ $100ã€‚ä½ ç™½èµšæƒåˆ©é‡‘ (æ”¶ç§Ÿ)ã€‚</li>
                            <li><strong>åœºæ™¯ B (å¤§è·Œ)ï¼š</strong> è‚¡ä»·è·Œåˆ° $80ã€‚ä½ <strong>å¿…é¡»</strong>æŒ‰ $90 ä¹°å…¥ã€‚</li>
                        </ul>
                        <p class="text-cyan-300 font-bold mt-2">é‡ç‚¹ï¼šåæ­£ä½ æœ¬æ¥å°±æƒ³åœ¨ $90 ä¹°ï¼ç°åœ¨ä½ ä¸ä»…ä¹°åˆ°äº†ï¼Œè¿˜é¢å¤–èµšäº†ä¸€ç¬”ä¿é™©è´¹ã€‚</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-bold text-gray-200 mb-4 text-center" data-i18n="sellPutChartTitle">å®é™…æŒä»“æˆæœ¬å¯¹æ¯”</h3>
                    <div class="chart-container">
                        <canvas id="sellPutChart"></canvas>
                    </div>
                    <p class="text-xs text-gray-400 text-center mt-2" data-i18n="sellPutChartCaption">Sell Put = å¸¦è¡¥è´´çš„é™ä»·ä¹°å•</p>
                </div>
            </div>
        </section>

        <!-- SECTION 5: THE SOLUTION - RISK REVERSAL -->
        <section id="risk-reversal" class="bg-gradient-to-br from-indigo-50 to-white rounded-2xl shadow-lg p-8 relative">
            <div class="text-center max-w-3xl mx-auto mb-10">
                <h2 class="text-3xl font-bold text-indigo-800 mb-4" data-i18n="rrTitle">ç»„åˆæŠ€ç­–ç•¥: Risk Reversal (é£é™©é€†è½¬)</h2>
                <p class="text-gray-600 text-lg" data-i18n="rrSubtitle">
                    ä¸ç”¨æé’±çš„â€œç©ºæ‰‹å¥—ç™½ç‹¼â€ï¼Ÿ<br>
                    <strong>é€»è¾‘ï¼š</strong> ç”¨â€œæ„¿æ„æ¥ç›˜çš„ä¹‰åŠ¡â€ (Sell Put) èµšæ¥çš„é’±ï¼Œå»ä¹°â€œä¸Šæ¶¨çš„å®šé‡‘â€ (Buy Call)ã€‚
                </p>
            </div>

            <!-- Flow Diagram -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-10 items-stretch">
                <!-- Step 1 -->
                <div class="bg-white p-4 rounded-lg shadow border-2 border-pink-200 flex flex-col items-center text-center">
                    <div class="text-2xl mb-2">ğŸ¤</div>
                    <h4 class="font-bold text-pink-600">Sell Put</h4>
                    <p class="text-xs text-gray-500 mt-2" data-i18n="rrStep1">
                        å–å‡ºé˜²è·Œä¿é™©<br>
                        "è·Œç ´97.5æˆ‘æ¥ç›˜"
                    </p>
                    <div class="text-xs text-gray-400 mt-1">Expire: December 5, 2025</div>
                    <div class="mt-auto pt-4 font-bold text-green-600" data-i18n="rrStep1Profit">+ æ”¶å– $2.00</div>
                </div>
                
                <!-- Arrow -->
                <div class="hidden md:flex items-center justify-center">
                    <div class="text-4xl text-gray-300">â¡ï¸</div>
                </div>
                <div class="md:hidden flex items-center justify-center py-2">
                    <div class="text-2xl text-gray-300">â¬‡ï¸</div>
                </div>

                <!-- Step 2 -->
                <div class="bg-white p-4 rounded-lg shadow border-2 border-indigo-200 flex flex-col items-center text-center">
                    <div class="text-2xl mb-2">ğŸš€</div>
                    <h4 class="font-bold text-indigo-600">Buy Call</h4>
                    <p class="text-xs text-gray-500 mt-2" data-i18n="rrStep2">
                        ä¹°å…¥çœ‹æ¶¨æƒåˆ©<br>
                        "æ¶¨è¿‡115æˆ‘èµšé’±"
                    </p>
                    <div class="text-xs text-gray-400 mt-1">Expire: December 5, 2025</div>
                    <div class="mt-auto pt-4 font-bold text-red-500" data-i18n="rrStep2Cost">- æ”¯ä»˜ $2.00</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                     <div class="chart-container">
                        <canvas id="riskReversalChart"></canvas>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-inner">
                    <h3 class="font-bold text-gray-800 mb-4" data-i18n="rrSummaryTitle">ç­–ç•¥æ€»ç»“</h3>
                    <ul class="space-y-4 text-sm text-gray-600">
                        <li class="flex items-start">
                            <span class="mr-2 mt-1 text-green-500">ğŸŸ¢</span>
                            <span data-i18n="rrSummaryWin"><strong>å¤§æ¶¨:</strong> ä¹Ÿå°±æ˜¯è‚¡ä»· > 115ï¼Œä½ æ‹¥æœ‰ Callï¼Œæ”¶ç›Šæ— é™ã€‚</span>
                        </li>
                         <li class="flex items-start">
                            <span class="mr-2 mt-1 text-yellow-500">ğŸŸ¡</span>
                            <span data-i18n="rrSummaryDraw"><strong>éœ‡è¡:</strong> åœ¨ 97.5 å’Œ 115 ä¹‹é—´ï¼Œä¸äºä¸èµšï¼ˆå› ä¸ºæƒåˆ©é‡‘ç›¸äº’æŠµæ¶ˆäº†ï¼‰ã€‚è‡ªå¸¦â€œå®‰å…¨ç¼“å†²åŒºâ€ã€‚</span>
                        </li>
                        <li class="flex items-start">
                            <span class="mr-2 mt-1 text-red-500">ğŸ”´</span>
                            <span data-i18n="rrSummaryLose"><strong>å¤§è·Œ:</strong> è·Œç ´ 97.5ï¼Œä½ éœ€è¦æŒ‰ 97.5 ä¹°å…¥è‚¡ç¥¨ã€‚ä½†è¿™æœ¬æ¥å°±æ˜¯ä½ å¿ƒä»ªçš„â€œæŠ„åº•ä»·â€ã€‚</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- HYBRID QUIZ SECTION -->
            <div class="mt-12 bg-indigo-900 rounded-xl p-8 text-white relative overflow-hidden">
                <div class="relative z-10 text-center">
                    <h3 class="text-2xl font-bold mb-2" data-i18n="quizTitle">âœ¨ ä»Šæ—¥æŒ‘æˆ˜ (Daily Challenge)</h3>
                    <p class="text-indigo-200 mb-6" data-i18n="quizSubtitle">æ£€æµ‹ä¸€ä¸‹ä½ æ˜¯å¦æŒæ¡äº† Risk Reversalï¼Ÿ</p>
                    
                    <!-- STATIC QUIZ CONTAINER (Always Visible) -->
                    <div id="staticQuizContainer" class="bg-white/10 backdrop-blur-sm rounded-lg p-6 text-left max-w-2xl mx-auto border border-white/20 mb-8">
                        <p class="text-lg font-bold mb-4" id="staticQText"></p>
                        <ul class="space-y-2 mb-4" id="staticQOptions">
                            <!-- Options injected via JS -->
                        </ul>
                        <button id="toggleAnswerBtn" class="text-sm bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded transition-colors">
                            <span data-i18n="revealAnswerBtn">æŸ¥çœ‹ç­”æ¡ˆä¸è§£æ</span>
                        </button>
                        <div id="staticAnswerContainer" class="hidden mt-4 pt-4 border-t border-white/20">
                            <p class="font-bold text-green-400 mb-1" id="staticQCorrect"></p>
                            <p class="text-sm text-gray-300" id="staticQExplain"></p>
                        </div>
                    </div>

                    <!-- DYNAMIC QUIZ GENERATOR (Requires Key) -->
                    <div class="border-t border-indigo-700 pt-6">
                         <p class="text-xs text-indigo-400 mb-3" data-i18n="quizAiPrompt">è¿˜æƒ³åšæ›´å¤šé¢˜ï¼Ÿä½¿ç”¨ AI ç”Ÿæˆæ— é™é¢˜ç›® (éœ€é…ç½® API Key)</p>
                        <button id="generateQuizBtn" class="bg-indigo-800 hover:bg-indigo-700 text-white border border-indigo-600 text-sm font-bold py-2 px-6 rounded-full shadow transition flex items-center gap-2 mx-auto">
                            <span>âš¡</span> <span data-i18n="quizBtn">ç”Ÿæˆæ–°é¢˜ç›® (Generate New)</span>
                        </button>
                        
                        <div id="dynamicQuizContainer" class="hidden mt-6 bg-black/20 rounded-lg p-6 text-left max-w-2xl mx-auto">
                            <!-- Dynamic Content -->
                        </div>
                    </div>
                </div>
                <!-- Decorative background elements -->
                <div class="absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 rounded-full bg-pink-500 opacity-20 filter blur-3xl"></div>
                <div class="absolute bottom-0 left-0 -ml-16 -mb-16 w-64 h-64 rounded-full bg-indigo-500 opacity-20 filter blur-3xl"></div>
            </div>

        </section>

    </main>

    <footer class="bg-gray-800 text-gray-400 py-8 mt-12 pb-24 md:pb-8">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">Generated by Gemini Canvas Infographics</p>
            <p class="text-xs">
                Data sources: Script based on "Thanksgiving Options Strategy". <br>
                Disclaimer: Financial visuals are for educational purposes only. Not investment advice.
            </p>
            <p class="text-xs mt-4 text-gray-600">NO SVG USED. NO MERMAID JS USED.</p>
        </div>
    </footer>

    <!-- GEMINI API FEATURE: FLOATING CHAT -->
    <div id="geminiChatWidget" class="fixed bottom-6 right-6 z-50 flex flex-col items-end">
        <!-- Chat Window (Hidden by default) -->
        <div id="chatWindow" class="hidden bg-white w-80 md:w-96 rounded-2xl shadow-2xl mb-4 flex flex-col border border-gray-200 overflow-hidden transform transition-all duration-300 origin-bottom-right">
            <div class="bg-gradient-to-r from-indigo-600 to-indigo-800 p-4 flex justify-between items-center text-white">
                <div class="flex items-center gap-2">
                    <div class="bg-white/20 p-1 rounded-full">âœ¨</div>
                    <span class="font-bold" data-i18n="chatTitle">Gemini åŠ©æ•™</span>
                </div>
                <button id="closeChatBtn" class="hover:bg-white/10 rounded p-1">âœ•</button>
            </div>
            <div id="chatMessages" class="chat-messages h-80 overflow-y-auto p-4 space-y-4 bg-gray-50 text-sm">
                <div class="flex gap-2">
                    <div class="bg-indigo-100 text-indigo-800 p-3 rounded-lg rounded-tl-none max-w-[85%]" data-i18n="chatWelcome">
                        ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„ AI æœŸæƒåŠ©æ•™ã€‚å…³äºä»Šå¤©çš„ Call, Put æˆ–è€… Risk Reversal ç­–ç•¥ï¼Œæœ‰ä»€ä¹ˆä¸æ‡‚çš„éƒ½å¯ä»¥é—®æˆ‘ï¼
                    </div>
                </div>
            </div>
            <div class="p-3 bg-white border-t border-gray-100">
                <form id="chatForm" class="flex gap-2">
                    <input type="text" id="userQuery" placeholder="è¾“å…¥ä½ çš„é—®é¢˜..." class="flex-1 border border-gray-300 rounded-full px-4 py-2 text-sm focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500" data-i18n-placeholder="chatPlaceholder">
                    <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white rounded-full p-2 w-10 h-10 flex items-center justify-center shadow-md transition-colors">
                        â¤
                    </button>
                </form>
            </div>
        </div>

        <!-- Floating Action Button -->
        <button id="toggleChatBtn" class="bg-gradient-to-r from-indigo-600 to-pink-500 hover:from-indigo-700 hover:to-pink-600 text-white rounded-full p-4 shadow-xl transform transition hover:scale-110 flex items-center gap-2 group">
            <span class="text-2xl">âœ¨</span>
            <span class="font-bold hidden group-hover:inline max-w-0 group-hover:max-w-xs transition-all duration-500 overflow-hidden whitespace-nowrap" data-i18n="askAiBtn">æé—® AI åŠ©æ•™</span>
        </button>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="settingsModal" class="fixed inset-0 z-[100] flex items-center justify-center hidden opacity-0 pointer-events-none modal bg-black/50 backdrop-blur-sm">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md modal-content m-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                    <span class="text-indigo-600">âš™ï¸</span> è®¾ç½® (Settings)
                </h3>
                <button id="closeSettingsBtn" class="text-gray-400 hover:text-gray-600 transition-colors">âœ•</button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">Google Gemini API Key</label>
                    <input type="password" id="apiKeyInput" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none" placeholder="è¾“å…¥æ‚¨çš„ API Key...">
                    <p class="text-xs text-gray-500 mt-2">
                        æ‚¨çš„ Key ä»…å­˜å‚¨åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­ï¼Œç»ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚
                        <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-indigo-600 hover:underline">ç‚¹å‡»è·å–å…è´¹ Key (Google AI Studio)</a>
                    </p>
                </div>
                
                <button id="saveApiKeyBtn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                    ä¿å­˜ / Save
                </button>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- TRANSLATION DATA ---
        const translations = {
            zh: {
                headerTitle: "æœŸæƒé›¶åŸºç¡€",
                headerBadge: "AI å¢å¼ºç‰ˆ",
                headerSubtitle: "Episode 1: ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å­¦æœŸæƒï¼Ÿ",
                introTitle: "æ„Ÿæ©èŠ‚æŠ•æœºï¼šåƒå‡ºæ¥çš„æœºä¼šï¼Ÿ",
                introText: "æ•…äº‹ä»ä¸€ä¸ªç®€å•çš„é€»è¾‘å¼€å§‹ï¼šæ„Ÿæ©èŠ‚å¤§å®¶åƒå¤ªå¤š -> èŠ‚åæƒ³è¦å‡è‚¥ -> å¥èº«æˆ¿ç”Ÿæ„ç«çˆ†ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåå°”è¡—ç›¯ä¸Šäº† Planet Fitness (æ˜Ÿçƒå¥èº«)ã€‚ä½†ä¸å…¶ç›´æ¥ä¹°è‚¡ç¥¨ï¼Œä¸“å®¶æ¨èäº†ä¸€ä¸ªåå­—é•¿åˆ°è®©äººçª’æ¯çš„ç­–ç•¥...",
                introStrategyNote: "ï¼ˆä¸­æ–‡åï¼šç‰›å¸‚ä»·å·®é£é™©é€†è½¬ç­–ç•¥ â€”â€” åå­—æ˜¯ä¸æ˜¯å¾ˆé•¿ï¼Ÿï¼‰",
                introChartCaption: "3000å¤§å¡/é¡¿çš„æ™šé¤å¼•å‘çš„æŠ•èµ„è´è¶æ•ˆåº”",
                callTitle: "Call (è®¤è´­æœŸæƒ)",
                callSubtitle: "æ ¸å¿ƒé€»è¾‘ï¼šäº¤å®šé‡‘ï¼Œé”ä»·æ ¼ (Buy Low, Sell High)",
                contractNote: "çŸ¥è¯†ç‚¹ï¼š1 å¼ æœŸæƒåˆçº¦ = 100 è‚¡è‚¡ç¥¨ã€‚<span class='font-normal'>ï¼ˆä¸‹æ–‡ä¸ºæ–¹ä¾¿ç†è§£ï¼Œä»·æ ¼å‡ä¸ºâ€œå•è‚¡â€ä»·æ ¼ï¼Œå®é™…äº¤æ˜“éœ€ x100ï¼‰</span>",
                callAnalogyTitle: "ç±»æ¯”ï¼šä¹°æˆ¿å®šé‡‘",
                callAnalogyText: "æƒ³è±¡ä½ çœ‹ä¸­ä¸€å¥—100ä¸‡çš„æˆ¿å­ã€‚ä½ æ”¯ä»˜äº† 1ä¸‡å…ƒå®šé‡‘ (æƒåˆ©é‡‘)ï¼Œé”å®šäº†ä¸‹ä¸ªæœˆç”¨100ä¸‡ä¹°æˆ¿çš„æƒåˆ©ã€‚",
                callScenarioWin: "<strong>è‹¥æˆ¿ä»·æ¶¨åˆ°120ä¸‡ï¼š</strong> ä½ æŒ‰100ä¸‡ä¹°å…¥ï¼Œè½¬æ‰‹å–å‡ºèµš20ä¸‡ã€‚å›æŠ¥ç‡ 2000%ï¼",
                callScenarioLose: "<strong>è‹¥æˆ¿ä»·è·Œåˆ°80ä¸‡ï¼š</strong> ä½ æ”¾å¼ƒå®šé‡‘ï¼ŒåªæŸå¤±1ä¸‡ã€‚æˆ¿å­ä¸è¦äº†ã€‚",
                callExampleTitle: "è‚¡å¸‚å®ä¾‹ï¼šè‹±ä¼Ÿè¾¾ (NVDA)",
                callExampleText: "è‚¡ä»· $100ã€‚ä½ èŠ± $5 ä¹°å…¥ Call (è¡Œæƒä»· $100)ã€‚<br>å¦‚æœæ¶¨åˆ° $150ï¼Œä½ èµš $45 ($150 - $100 - $5)ã€‚<br>ç¿»äº†9å€ï¼è¿™å°±æ˜¯<strong>ä»¥å°åšå¤§</strong>ã€‚",
                callChartCaption: "Call Option æŸç›Šæ›²çº¿ï¼šé£é™©æœ‰é™ï¼Œæ”¶ç›Šæ— é™",
                putTitle: "Put (è®¤æ²½æœŸæƒ)",
                putSubtitle: "æ ¸å¿ƒé€»è¾‘ï¼šä¹°ä¿é™©ï¼Œé˜²ç¾å®³ (Hedging / Protection)",
                putAnalogyTitle: "ç±»æ¯”ï¼šè½¦é™© (Tesla Model Y)",
                putAnalogyText: "æƒ³è±¡ä½ åˆšä¹°äº†ä¸€è¾†ç‰¹æ–¯æ‹‰ Model Y (ä»·å€¼ $5ä¸‡)ã€‚ä½ æ€•æ’è½¦å½’é›¶ï¼Œäºæ˜¯èŠ± $1000 ä¹°ä¿é™© (Put)ã€‚<br><strong>ä¿é™©æ¡æ¬¾ (è¡Œæƒä»· $5ä¸‡)ï¼š</strong><br>å¦‚æœè½¦å­å…¨æŸ (ä»·å€¼å½’ 0)ï¼Œä¿é™©å…¬å¸èµ”ä½  $5ä¸‡ã€‚",
                putActionText: "<strong>åœ¨è‚¡å¸‚é‡Œï¼š</strong><br>ä½ æŒæœ‰è‚¡ç¥¨ (Model Y)ï¼Œä¹°å…¥ Put (è½¦é™©)ã€‚<br>å³ä½¿å…¬å¸å€’é—­ (è‚¡ä»·å½’0)ï¼Œä½ æœ‰æƒæŒ‰ <strong>$5ä¸‡ (è¡Œæƒä»·)</strong> æŠŠåºŸçº¸å–ç»™ä¿é™©å…¬å¸ã€‚<br>ä½ çš„æœ€å¤§æŸå¤±ä»…ä¸º $1000 (ä¿è´¹)ã€‚",
                sellPutTitle: "ä¸ºä»€ä¹ˆè¦åšâ€œä¿é™©å…¬å¸â€ (Sell Put)?",
                sellPutIntro: "å¯¹æ•£æˆ·æ¥è¯´ï¼Œå–ä¿é™©å¬èµ·æ¥å¾ˆç–¯ç‹‚ã€‚ä½†å¯¹å·´è²ç‰¹æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ç¬”å®Œç¾çš„ç”Ÿæ„ï¼š",
                sellPutQuote: "\"æˆ‘æƒ³ä¹°è¿™åªè‚¡ç¥¨ï¼Œä½†ç°åœ¨çš„ä»·æ ¼($100)å¤ªè´µã€‚å¦‚æœè·Œåˆ° $90ï¼Œæˆ‘æ„¿æ„å…¨ä»“æ¥ç›˜ã€‚\"",
                sellPutLogic: "<p><strong>æ“ä½œï¼š</strong> å–å‡º $90 çš„ Putï¼Œæ”¶å…¥ $2 çš„æƒåˆ©é‡‘ã€‚</p><ul class='list-disc pl-5 space-y-2'><li><strong>åœºæ™¯ A (ä¸è·Œ)ï¼š</strong> è‚¡ä»·ä¿æŒåœ¨ $100ã€‚ä½ ç™½èµšæƒåˆ©é‡‘ (æ”¶ç§Ÿ)ã€‚</li><li><strong>åœºæ™¯ B (å¤§è·Œ)ï¼š</strong> è‚¡ä»·è·Œåˆ° $80ã€‚ä½ <strong>å¿…é¡»</strong>æŒ‰ $90 ä¹°å…¥ã€‚å®é™…æˆæœ¬ä¸º $88 ($90 - $2)ã€‚</li></ul><p class='text-cyan-300 font-bold mt-2'>é‡ç‚¹ï¼šåæ­£ä½ æœ¬æ¥å°±æƒ³åœ¨ $90 ä¹°ï¼ç°åœ¨ä½ ä¸ä»…ä¹°åˆ°äº†ï¼Œè¿˜é¢å¤–èµšäº†ä¸€ç¬”ä¿é™©è´¹ã€‚</p>",
                sellPutChartTitle: "å®é™…æŒä»“æˆæœ¬å¯¹æ¯”",
                sellPutChartCaption: "Sell Put = å¸¦è¡¥è´´çš„é™ä»·ä¹°å•",
                rrTitle: "ç»„åˆæŠ€ç­–ç•¥: Risk Reversal (é£é™©é€†è½¬)",
                rrSubtitle: "ä¸ç”¨æé’±çš„â€œç©ºæ‰‹å¥—ç™½ç‹¼â€ï¼Ÿ<br><strong>é€»è¾‘ï¼š</strong> ç”¨â€œæ„¿æ„æ¥ç›˜çš„ä¹‰åŠ¡â€ (Sell Put) èµšæ¥çš„é’±ï¼Œå»ä¹°â€œä¸Šæ¶¨çš„å®šé‡‘â€ (Buy Call)ã€‚",
                rrStep1: "å–å‡ºé˜²è·Œä¿é™©<br>\"è·Œç ´97.5æˆ‘æ¥ç›˜\"",
                rrStep1Profit: "+ æ”¶å– $2.00",
                rrStep2: "ä¹°å…¥çœ‹æ¶¨æƒåˆ©<br>\"æ¶¨è¿‡115æˆ‘èµšé’±\"",
                rrStep2Cost: "- æ”¯ä»˜ $2.00",
                rrSummaryTitle: "ç­–ç•¥æ€»ç»“",
                rrSummaryWin: "<strong>å¤§æ¶¨:</strong> ä¹Ÿå°±æ˜¯è‚¡ä»· > 115ï¼Œä½ æ‹¥æœ‰ Callï¼Œæ”¶ç›Šæ— é™ã€‚",
                rrSummaryDraw: "<strong>éœ‡è¡:</strong> åœ¨ 97.5 å’Œ 115 ä¹‹é—´ï¼Œä¸äºä¸èµšï¼ˆå› ä¸ºæƒåˆ©é‡‘ç›¸äº’æŠµæ¶ˆäº†ï¼‰ã€‚è‡ªå¸¦â€œå®‰å…¨ç¼“å†²åŒºâ€ã€‚",
                rrSummaryLose: "<strong>å¤§è·Œ:</strong> è·Œç ´ 97.5ï¼Œä½ éœ€è¦æŒ‰ 97.5 ä¹°å…¥è‚¡ç¥¨ã€‚ä½†è¿™æœ¬æ¥å°±æ˜¯ä½ å¿ƒä»ªçš„â€œæŠ„åº•ä»·â€ã€‚",
                quizTitle: "âœ¨ ä»Šæ—¥æŒ‘æˆ˜ (Daily Challenge)",
                quizSubtitle: "æ£€æµ‹ä¸€ä¸‹ä½ æ˜¯å¦æŒæ¡äº† Risk Reversalï¼Ÿ",
                quizBtn: "ç”Ÿæˆæ–°é¢˜ç›® (Generate New)",
                quizAiPrompt: "è¿˜æƒ³åšæ›´å¤šé¢˜ï¼Ÿä½¿ç”¨ AI ç”Ÿæˆæ— é™é¢˜ç›® (éœ€é…ç½® API Key)",
                revealAnswerBtn: "æŸ¥çœ‹ç­”æ¡ˆä¸è§£æ",
                quizLoading: "æ­£åœ¨æ€è€ƒé¢˜ç›®...",
                chatTitle: "Gemini åŠ©æ•™",
                chatWelcome: "ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„ AI æœŸæƒåŠ©æ•™ã€‚å…³äºä»Šå¤©çš„ Call, Put æˆ–è€… Risk Reversal ç­–ç•¥ï¼Œæœ‰ä»€ä¹ˆä¸æ‡‚çš„éƒ½å¯ä»¥é—®æˆ‘ï¼",
                chatPlaceholder: "è¾“å…¥ä½ çš„é—®é¢˜...",
                askAiBtn: "æé—® AI åŠ©æ•™",
                // Static Quiz Content
                staticQText: "Risk Reversal (é£é™©é€†è½¬) ç­–ç•¥çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šSell Put çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ",
                staticQOptions: [
                    "A. èµŒè‚¡ç¥¨å¤§è·Œï¼Œèµšå–æŠ•æœºæ”¶ç›Šã€‚",
                    "B. ä»…ä»…ä¸ºäº†èµšå–æœŸæƒè´¹ï¼ˆæ”¶ç§Ÿï¼‰ã€‚",
                    "C. èµšå–æƒåˆ©é‡‘æ¥è¡¥è´´ä¹° Call çš„æˆæœ¬ï¼Œå¹¶æ„¿æ„åœ¨ä¸‹è·Œæ—¶ä»¥è¡Œæƒä»·æ¥ç›˜ä¹°å…¥è‚¡ç¥¨ã€‚"
                ],
                staticQCorrect: "æ­£ç¡®ç­”æ¡ˆï¼šC",
                staticQExplain: "è§£æï¼šRisk Reversal çš„ç²¾é«“åœ¨äºâ€œé›¶æˆæœ¬â€æ„å»ºã€‚å–å‡º Put çš„æ ¸å¿ƒç›®çš„æ˜¯ä¸ºä¹°å…¥ Call æä¾›èµ„é‡‘æ”¯æŒï¼ŒåŒæ—¶è®¾å®šä¸€ä¸ªè‡ªå·±æ„¿æ„æ¥å—çš„â€œæŠ„åº•ä»·â€ï¼ˆPut è¡Œæƒä»·ï¼‰ã€‚",
                // Charts Data
                chartCaloriesLabel: "å¡è·¯é‡Œæ‘„å…¥ (kcal)",
                chartCaloriesTitle: "æš´é¥®æš´é£Ÿé©±åŠ¨çš„å¥èº«éœ€æ±‚",
                chartCallLabel: "ç›ˆäºé‡‘é¢ ($)",
                chartCallTitle: "Call Payoff: è‚¡ä»·æ¶¨å¾—è¶Šé«˜èµšå¾—è¶Šå¤š",
                chartPutLabels: ["ä¸ä¹°ä¿é™© (è£¸å¥”)", "ä¹°äº† Put (æœ‰ä¿é™©)"],
                chartPutLabel: "æŠ•èµ„ç»„åˆæ€»ä»·å€¼ ($)",
                chartPutTitle: "è½¦ç¥¸ç°åœº (è‚¡ä»·æš´è·Œ)ï¼šæœ‰æ— ä¿é™©çš„èµ„äº§å¯¹æ¯”",
                chartSellPutLabels: ["ç›´æ¥ä¹°å…¥ç°ä»·è‚¡ç¥¨", "å–å‡º Put æ¥ç›˜"],
                chartSellPutLabel: "å®é™…æŒä»“æˆæœ¬ ($)",
                chartSellPutTitle: "å·´è²ç‰¹å¦‚ä½•ç”¨\"æŠ˜æ‰£ä»·\"ä¹°è‚¡",
                chartRRLabel: "Risk Reversal ç­–ç•¥",
                chartRRStockLabel: "ç›´æ¥æŒæœ‰è‚¡ç¥¨ (æ— ä¿æŠ¤)",
                chartRRTitle: "ç­–ç•¥å¯¹æ¯”ï¼šRisk Reversal vs ç›´æ¥ä¹°æ­£è‚¡"
            },
            en: {
                headerTitle: "Options from Zero",
                headerBadge: "AI Enhanced",
                headerSubtitle: "Episode 1: Why learn Options?",
                introTitle: "Thanksgiving Speculation",
                introText: "Simple logic: Thanksgiving Overeating -> Post-holiday Weight Loss -> Gym Boom. That's why Wall Street is eyeing <strong>Planet Fitness</strong>. But experts recommend a strategy with a terrifyingly long name...",
                introStrategyNote: "(Long name, right?)",
                introChartCaption: "Investment butterfly effect from a 3000 kcal dinner",
                callTitle: "Call Option",
                callSubtitle: "Logic: Down payment to lock price (Buy Low, Sell High)",
                contractNote: "Note: 1 Option Contract = 100 Shares. <span class='font-normal'>(Prices below are per share for simplicity, real trade is x100)</span>",
                callAnalogyTitle: "Analogy: House Deposit",
                callAnalogyText: "You see a $1M house. You pay <strong>$10k deposit (Premium)</strong> to lock the right to buy at $1M next month.",
                callScenarioWin: "<strong>Price hits $1.2M:</strong> Buy at $1M, sell at $1.2M. Profit $200k (2000% return)!",
                callScenarioLose: "<strong>Price drops to $800k:</strong> Walk away. Lose only deposit ($10k).",
                callExampleTitle: "Stock Example: NVIDIA (NVDA)",
                callExampleText: "Stock $100. Buy Call (Strike $100) for $5.<br>If it hits $150, you earn $45 ($150 - $100 - $5).<br>9x Return! This is <strong>Leverage</strong>.",
                callChartCaption: "Call Payoff: Limited Risk, Unlimited Upside",
                putTitle: "Put Option",
                putSubtitle: "Logic: Insurance against disaster (Hedging)",
                putAnalogyTitle: "Analogy: Car Insurance (Tesla Model Y)",
                putAnalogyText: "Imagine you bought a Tesla Model Y ($50k). Afraid of totaling it, you buy insurance ($1k).<br><strong>Policy (Strike $50k):</strong><br>If the car is totaled (Value $0), insurance pays you $50k.",
                putActionText: "<strong>In Stock Market:</strong><br>You own stock (Model Y), buy Put (Insurance).<br>Even if company goes bankrupt (Price $0), you sell the 'scrap' to insurer for <strong>$50k (Strike)</strong>.<br>Max loss is just $1k (Premium).",
                sellPutTitle: "Why be the \"Insurer\" (Sell Put)?",
                sellPutIntro: "Beginners buy insurance, <strong>Pros sell insurance</strong>. Like Buffett, it's a perfect business:",
                sellPutQuote: "\"I want to buy this stock, but it's too expensive ($100). If it drops to $90, I'll buy it all.\"",
                sellPutLogic: "<p><strong>Action:</strong> Sell $90 Put, collect premium.</p><ul class='list-disc pl-5 space-y-2'><li><strong>Scenario A (Flat):</strong> Price stays $100. Keep premium (Free money).</li><li><strong>Scenario B (Crash):</strong> Price drops to $80. You <strong>MUST</strong> buy at $90.</li></ul><p class='text-cyan-300 font-bold mt-2'>Point: You wanted to buy at $90 anyway! Now you got the stock + extra cash.</p>",
                sellPutChartTitle: "Cost Basis Comparison",
                sellPutChartCaption: "Sell Put = Limit Order with Subsidy",
                rrTitle: "Combination Strategy: Risk Reversal",
                rrSubtitle: "Zero-Cost Entry?<br><strong>Logic:</strong> Use money from \"Obligation to Buy\" (Sell Put) to fund \"Right to Buy\" (Buy Call).",
                rrStep1: "Sell Downside Insurance<br>\"I'll buy if < 97.5\"",
                rrStep1Profit: "+ Collect $2.00",
                rrStep2: "Buy Upside Potential<br>\"I profit if > 115\"",
                rrStep2Cost: "- Pay $2.00",
                rrSummaryTitle: "Strategy Summary",
                rrSummaryWin: "<strong>Rally:</strong> Price > 115. You own the Call. Unlimited profit.",
                rrSummaryDraw: "<strong>Chop:</strong> Between 97.5 & 115. Breakeven (Premiums cancel out). Built-in buffer.",
                rrSummaryLose: "<strong>Crash:</strong> Price < 97.5. You buy stock at 97.5. But that was your target dip-buy price anyway.",
                quizTitle: "âœ¨ Daily Challenge",
                quizSubtitle: "Test your mastery of Risk Reversal.",
                quizBtn: "Generate New (Requires Key)",
                quizAiPrompt: "Want more practice? Use AI to generate infinite questions.",
                revealAnswerBtn: "Reveal Answer & Explanation",
                quizLoading: "Generating question...",
                chatTitle: "Gemini Tutor",
                chatWelcome: "Hello! I'm your AI Options Tutor. Ask me anything about Calls, Puts, or Risk Reversal!",
                chatPlaceholder: "Ask a question...",
                askAiBtn: "Ask AI Tutor",
                // Static Quiz Content
                staticQText: "In a Risk Reversal strategy, what is the primary purpose of Selling the Put?",
                staticQOptions: [
                    "A. To bet on a massive stock crash.",
                    "B. Just to collect premium (income).",
                    "C. To fund the purchase of the Call, while being willing to buy the stock at a discount if it drops."
                ],
                staticQCorrect: "Correct Answer: C",
                staticQExplain: "Explanation: The essence of Risk Reversal is the 'Zero-Cost' setup. Selling the Put funds the Call, and acts as a Limit Order to buy the stock at a price you are happy with (the Put Strike).",
                // Charts Data
                chartCaloriesLabel: "Calories (kcal)",
                chartCaloriesTitle: "Overeating driving Gym Demand",
                chartCallLabel: "Profit/Loss ($)",
                chartCallTitle: "Call Payoff: The higher it goes, the more you make",
                chartPutLabels: ["No Insurance", "With Put Protection"],
                chartPutLabel: "Portfolio Value ($)",
                chartPutTitle: "Car Crash (Market Crash): Asset Value Comparison",
                chartSellPutLabels: ["Buy Stock Now", "Sell Put Entry"],
                chartSellPutLabel: "Cost Basis ($)",
                chartSellPutTitle: "Buffett's Discount Entry",
                chartRRLabel: "Risk Reversal Strategy",
                chartRRStockLabel: "Long Stock (No Protection)",
                chartRRTitle: "Strategy Comparison: Risk Reversal vs Long Stock"
            },
            ja: {
                headerTitle: "ã‚¼ãƒ­ã‹ã‚‰å§‹ã‚ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³",
                headerBadge: "AIæ­è¼‰",
                headerSubtitle: "ç¬¬1è©±ï¼šãªãœã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å­¦ã¶ã®ã‹ï¼Ÿ",
                introTitle: "æ„Ÿè¬ç¥­ã®æŠ•æ©Ÿï¼šé£Ÿã¹éããŒãƒãƒ£ãƒ³ã‚¹ï¼Ÿ",
                introText: "å˜ç´”ãªãƒ­ã‚¸ãƒƒã‚¯ã§ã™ã€‚æ„Ÿè¬ç¥­ã§é£Ÿã¹éãã‚‹ -> æ¸›é‡ã—ãŸããªã‚‹ -> ã‚¸ãƒ ãŒå„²ã‹ã‚‹ã€‚ã ã‹ã‚‰ã‚¦ã‚©ãƒ¼ãƒ«è¡—ã¯ <strong>Planet Fitness</strong> ã«æ³¨ç›®ã—ã¦ã„ã¾ã™ã€‚ã—ã‹ã—å°‚é–€å®¶ã¯æã‚ã—ãé•·ã„åå‰ã®æˆ¦ç•¥ã‚’æ¨å¥¨ã—ã¦ã„ã¾ã™...",
                introStrategyNote: "ï¼ˆåå‰ãŒé•·ã™ãã‚‹ã‚ˆã­ï¼Ÿï¼‰",
                introChartCaption: "3000kcalã®å¤•é£ŸãŒå¼•ãèµ·ã“ã™æŠ•è³‡ã®ãƒã‚¿ãƒ•ãƒ©ã‚¤åŠ¹æœ",
                callTitle: "Call (ã‚³ãƒ¼ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³)",
                callSubtitle: "ãƒ­ã‚¸ãƒƒã‚¯ï¼šæ‰‹ä»˜é‡‘ã§ä¾¡æ ¼ã‚’ãƒ­ãƒƒã‚¯ (å®‰ãè²·ã£ã¦é«˜ãå£²ã‚‹)",
                contractNote: "çŸ¥è­˜ç‚¹ï¼š1 ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¥‘ç´„ = 100 æ ªã€‚<span class='font-normal'>ï¼ˆä»¥ä¸‹ã¯åˆ†ã‹ã‚Šã‚„ã™ãã™ã‚‹ãŸã‚1æ ªã‚ãŸã‚Šã®ä¾¡æ ¼ã§ã™ã€‚å®Ÿéš›ã®å–å¼•ã¯ x100ï¼‰</span>",
                callAnalogyTitle: "ä¾‹ãˆï¼šå®¶ã®æ‰‹ä»˜é‡‘",
                callAnalogyText: "1å„„å††ã®å®¶ã‚’è¦‹ã¤ã‘ãŸã¨ã—ã¾ã™ã€‚<strong>100ä¸‡å††ã®æ‰‹ä»˜é‡‘ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ï¼‰</strong>ã‚’æ‰•ã„ã€æ¥æœˆ1å„„å††ã§è²·ã†æ¨©åˆ©ã‚’ç¢ºä¿ã—ã¾ã™ã€‚",
                callScenarioWin: "<strong>1.2å„„å††ã«é«˜é¨°ï¼š</strong> 1å„„ã§è²·ã„ã€1.2å„„ã§å£²ã‚‹ã€‚2000ä¸‡å††ã®åˆ©ç›Š (20å€)ï¼",
                callScenarioLose: "<strong>8000ä¸‡å††ã«æš´è½ï¼š</strong> æ¨©åˆ©æ”¾æ£„ã€‚æå¤±ã¯æ‰‹ä»˜é‡‘ã®100ä¸‡å††ã®ã¿ã€‚",
                callExampleTitle: "æ ªå¼ã®ä¾‹ï¼šNVIDIA (NVDA)",
                callExampleText: "æ ªä¾¡ $100ã€‚$5ã§Call (è¡Œä½¿ä¾¡æ ¼ $100) ã‚’è³¼å…¥ã€‚<br>$150ã«ãªã‚Œã°ã€$45ã®åˆ©ç›Š ($150 - $100 - $5)ã€‚<br>9å€ã®ãƒªã‚¿ãƒ¼ãƒ³ï¼ã“ã‚ŒãŒ<strong>ãƒ¬ãƒãƒ¬ãƒƒã‚¸</strong>ã§ã™ã€‚",
                callChartCaption: "Callã®æç›Šï¼šãƒªã‚¹ã‚¯é™å®šã€åˆ©ç›Šç„¡é™å¤§",
                putTitle: "Put (ãƒ—ãƒƒãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³)",
                putSubtitle: "ãƒ­ã‚¸ãƒƒã‚¯ï¼šç½å®³ä¿é™º (ãƒ˜ãƒƒã‚¸)",
                putAnalogyTitle: "ä¾‹ãˆï¼šè‡ªå‹•è»Šä¿é™º (Tesla Model Y)",
                putAnalogyText: "ãƒ†ã‚¹ãƒ© Model Y ($5ä¸‡) ã‚’è²·ã£ãŸã¨æƒ³åƒã—ã¦ãã ã•ã„ã€‚å…¨æãŒæ€–ã„ã®ã§ $1000 ã§ä¿é™º (Put) ã‚’è²·ã„ã¾ã™ã€‚<br><strong>ä¿é™ºæ¡é … (è¡Œä½¿ä¾¡æ ¼ $5ä¸‡)ï¼š</strong><br>è»ŠãŒå…¨æ (ä¾¡å€¤ $0) ã—ã¦ã‚‚ã€ä¿é™ºä¼šç¤¾ãŒ $5ä¸‡ æ”¯æ‰•ã„ã¾ã™ã€‚",
                putActionText: "<strong>æ ªå¼å¸‚å ´ã§ã¯ï¼š</strong><br>æ ª (Model Y) ã‚’æŒã¡ã€Put (ä¿é™º) ã‚’è²·ã†ã€‚<br>ä¼šç¤¾ãŒå€’ç”£ (æ ªä¾¡ $0) ã—ã¦ã‚‚ã€<strong>$5ä¸‡ (è¡Œä½¿ä¾¡æ ¼)</strong> ã§ä¿é™ºä¼šç¤¾ã«å£²å´å¯èƒ½ã€‚<br>æœ€å¤§æå¤±ã¯ $1000 (ä¿é™ºæ–™) ã®ã¿ã€‚",
                sellPutTitle: "ãªãœã€Œä¿é™ºä¼šç¤¾ã€ã«ãªã‚‹ã®ã‹ (Sell Put)?",
                sellPutIntro: "åˆå¿ƒè€…ã¯ä¿é™ºã‚’è²·ã„ã€<strong>ãƒ—ãƒ­ã¯ä¿é™ºã‚’å£²ã‚Šã¾ã™</strong>ã€‚ãƒãƒ•ã‚§ãƒƒãƒˆã«ã¨ã£ã¦ã€ã“ã‚Œã¯å®Œç’§ãªãƒ“ã‚¸ãƒã‚¹ã§ã™ï¼š",
                sellPutQuote: "ã€Œã“ã®æ ªã‚’è²·ã„ãŸã„ãŒã€ä»Šã¯é«˜ã™ãã‚‹($100)ã€‚ã‚‚ã—$90ã¾ã§ä¸‹ãŒã£ãŸã‚‰ã€å…¨åŠ›ã§è²·ã†ã€‚ã€",
                sellPutLogic: "<p><strong>æ“ä½œï¼š</strong> $90ã®Putã‚’å£²ã‚Šã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’å—å–ã‚‹ã€‚</p><ul class='list-disc pl-5 space-y-2'><li><strong>ã‚·ãƒŠãƒªã‚ª A (ä¸‹ãŒã‚‰ãªã„)ï¼š</strong> æ ªä¾¡ $100 ç¶­æŒã€‚ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¸¸å„²ã‘ã€‚</li><li><strong>ã‚·ãƒŠãƒªã‚ª B (æš´è½)ï¼š</strong> æ ªä¾¡ $80 ã«ä¸‹è½ã€‚ã‚ãªãŸã¯ $90 ã§è²·ã†<strong>ç¾©å‹™</strong>ãŒã‚ã‚‹ã€‚</li></ul><p class='text-cyan-300 font-bold mt-2'>ãƒã‚¤ãƒ³ãƒˆï¼šã©ã†ã› $90 ã§è²·ã„ãŸã‹ã£ãŸï¼æ ªã‚‚æ‰‹ã«å…¥ã‚Šã€ãŠå°é£ã„ã‚‚å¢—ãˆãŸã€‚</p>",
                sellPutChartTitle: "å–å¾—ã‚³ã‚¹ãƒˆã®æ¯”è¼ƒ",
                sellPutChartCaption: "Sell Put = è£œåŠ©é‡‘ä»˜ãã®æŒ‡å€¤æ³¨æ–‡",
                rrTitle: "çµ„ã¿åˆã‚ã›æˆ¦ç•¥: Risk Reversal",
                rrSubtitle: "ã‚¿ãƒ€ã§ã‚¨ãƒ³ãƒˆãƒªãƒ¼ï¼Ÿ<br><strong>ãƒ­ã‚¸ãƒƒã‚¯ï¼š</strong> ã€Œè²·ã†ç¾©å‹™ã€(Sell Put) ã§å¾—ãŸé‡‘ã§ã€ã€Œè²·ã†æ¨©åˆ©ã€(Buy Call) ã‚’è²·ã†ã€‚",
                rrStep1: "ä¸‹è½ä¿é™ºã‚’å£²ã‚‹<br>ã€Œ97.5ä»¥ä¸‹ãªã‚‰è²·ã†ã‚ˆã€",
                rrStep1Profit: "+ å—å– $2.00",
                rrStep2: "ä¸Šæ˜‡ç›Šã‚’è²·ã†<br>ã€Œ115è¶…ãˆãŸã‚‰åˆ©ç›Šã€",
                rrStep2Cost: "- æ”¯æ‰• $2.00",
                rrSummaryTitle: "æˆ¦ç•¥ã¾ã¨ã‚",
                rrSummaryWin: "<strong>é«˜é¨°:</strong> æ ªä¾¡ > 115ã€‚Callã‚’æŒã£ã¦ã„ã‚‹ã®ã§åˆ©ç›Šç„¡é™å¤§ã€‚",
                rrSummaryDraw: "<strong>æ¨ªã°ã„:</strong> 97.5 ã€œ 115ã€‚æç›Šåˆ†å²ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç›¸æ®ºï¼‰ã€‚å®‰å…¨ãƒãƒƒãƒ•ã‚¡ã‚ã‚Šã€‚",
                rrSummaryLose: "<strong>æš´è½:</strong> æ ªä¾¡ < 97.5ã€‚97.5ã§æ ªã‚’è²·ã†ç¾©å‹™ã€‚ã§ã‚‚ãã‚Œã¯å…ƒã€…ã®ã€ŒæŠ¼ã—ç›®è²·ã„ã€ç›®æ¨™ä¾¡æ ¼ã§ã™ã€‚",
                quizTitle: "âœ¨ ä»Šæ—¥ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸",
                quizSubtitle: "Risk Reversalã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ãŸã‹ï¼Ÿ",
                quizBtn: "æ–°ã—ã„å•é¡Œã‚’ç”Ÿæˆ (API KeyãŒå¿…è¦)",
                quizAiPrompt: "ã‚‚ã£ã¨ç·´ç¿’ã—ãŸã„ã§ã™ã‹ï¼ŸAIã‚’ä½¿ã£ã¦ç„¡é™ã«å•é¡Œã‚’ç”Ÿæˆã—ã¾ã—ã‚‡ã†ã€‚",
                revealAnswerBtn: "ç­”ãˆã¨è§£èª¬ã‚’è¦‹ã‚‹",
                quizLoading: "å‡ºé¡Œä¸­...",
                chatTitle: "Gemini è¬›å¸«",
                chatWelcome: "ã“ã‚“ã«ã¡ã¯ï¼AIã‚ªãƒ—ã‚·ãƒ§ãƒ³è¬›å¸«ã§ã™ã€‚Callã€Putã€Risk Reversalã«ã¤ã„ã¦ä½•ã§ã‚‚èã„ã¦ãã ã•ã„ï¼",
                chatPlaceholder: "è³ªå•ã‚’å…¥åŠ›...",
                askAiBtn: "AIè¬›å¸«ã«è³ªå•",
                // Static Quiz Content
                staticQText: "Risk Reversal æˆ¦ç•¥ã«ãŠã„ã¦ã€Putã‚’å£²ã‚‹ï¼ˆSell Putï¼‰ä¸»ãªç›®çš„ã¯ä½•ã§ã™ã‹ï¼Ÿ",
                staticQOptions: [
                    "A. æ ªä¾¡ã®å¤§æš´è½ã«è³­ã‘ã‚‹ãŸã‚ã€‚",
                    "B. å˜ã«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ï¼ˆåå…¥ï¼‰ã‚’å¾—ã‚‹ãŸã‚ã€‚",
                    "C. Callã‚’è²·ã†è³‡é‡‘ã‚’èª¿é”ã—ã¤ã¤ã€ã‚‚ã—ä¸‹ãŒã‚Œã°å–œã‚“ã§ãã®ä¾¡æ ¼ã§æ ªã‚’è²·ã†ãŸã‚ã€‚"
                ],
                staticQCorrect: "æ­£è§£ï¼šC",
                staticQExplain: "è§£èª¬ï¼šRisk Reversalã®çœŸé«„ã¯ã€Œã‚³ã‚¹ãƒˆã‚¼ãƒ­ã€ã«ã‚ã‚Šã¾ã™ã€‚Putã‚’å£²ã‚‹ã“ã¨ã§Callã®è³¼å…¥è³‡é‡‘ã‚’è³„ã„ã€åŒæ™‚ã«è‡ªåˆ†ãŒç´å¾—ã§ãã‚‹ä¾¡æ ¼ï¼ˆPutã®è¡Œä½¿ä¾¡æ ¼ï¼‰ã§ã®ã€ŒæŒ‡å€¤è²·ã„æ³¨æ–‡ã€ã¨ã—ã¦æ©Ÿèƒ½ã•ã›ã¾ã™ã€‚",
                // Charts Data
                chartCaloriesLabel: "æ‘‚å–ã‚«ãƒ­ãƒªãƒ¼ (kcal)",
                chartCaloriesTitle: "éé£ŸãŒç‰½å¼•ã™ã‚‹ã‚¸ãƒ éœ€è¦",
                chartCallLabel: "æç›Šé¡ ($)",
                chartCallTitle: "Call Payoff: ä¸ŠãŒã‚‹ã»ã©å„²ã‹ã‚‹",
                chartPutLabels: ["ä¿é™ºãªã— (è£¸)", "ä¿é™ºã‚ã‚Š (Put)"],
                chartPutLabel: "è³‡ç”£ç·é¡ ($)",
                chartPutTitle: "äº‹æ•…ç™ºç”Ÿ (æš´è½)ï¼šè³‡ç”£ä¾¡å€¤ã®æ¯”è¼ƒ",
                chartSellPutLabels: ["ç¾ç‰©è²·ã„", "Putå£²ã‚Šã‚¨ãƒ³ãƒˆãƒªãƒ¼"],
                chartSellPutLabel: "å–å¾—ã‚³ã‚¹ãƒˆ ($)",
                chartSellPutTitle: "ãƒãƒ•ã‚§ãƒƒãƒˆæµã®å‰²å¼•ã‚¨ãƒ³ãƒˆãƒªãƒ¼",
                chartRRLabel: "Risk Reversal æˆ¦ç•¥",
                chartRRStockLabel: "ç¾ç‰©æ ªä¿æœ‰ (ä¿è­·ãªã—)",
                chartRRTitle: "æˆ¦ç•¥æ¯”è¼ƒï¼šRisk Reversal vs ç¾ç‰©æ ª"
            }
        };

        // --- GEMINI API CONFIGURATION ---
        let currentLang = 'zh';

        // --- SETTINGS MODAL LOGIC ---
        const settingsBtn = document.getElementById('settingsBtn');
        const settingsModal = document.getElementById('settingsModal');
        const closeSettingsBtn = document.getElementById('closeSettingsBtn');
        const saveApiKeyBtn = document.getElementById('saveApiKeyBtn');
        const apiKeyInput = document.getElementById('apiKeyInput');

        function openSettings() {
            settingsModal.classList.remove('hidden');
            // Small timeout to allow transition
            setTimeout(() => settingsModal.classList.add('open'), 10);
            apiKeyInput.value = localStorage.getItem('gemini_api_key') || '';
        }

        function closeSettings() {
            settingsModal.classList.remove('open');
            setTimeout(() => settingsModal.classList.add('hidden'), 300);
        }

        settingsBtn.addEventListener('click', openSettings);
        closeSettingsBtn.addEventListener('click', closeSettings);
        
        // Close on background click
        settingsModal.addEventListener('click', (e) => {
            if (e.target === settingsModal) closeSettings();
        });

        saveApiKeyBtn.addEventListener('click', () => {
            const key = apiKeyInput.value.trim();
            if (key) {
                localStorage.setItem('gemini_api_key', key);
                closeSettings();
                alert('API Key Saved! / å·²ä¿å­˜ï¼');
            } else {
                alert('Please enter a valid key. / è¯·è¾“å…¥æœ‰æ•ˆçš„ Keyã€‚');
            }
        });

        const systemPrompts = {
            zh: {
                tutor: "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„é‡‘èæœŸæƒå¯¼å¸ˆ 'Gemini'ï¼Œæ­£åœ¨ä¸ºåˆå­¦è€…è®²è§£ã€Šä»é›¶å¼€å§‹å­¦æœŸæƒã€‹çš„è¯¾ç¨‹ã€‚ä½ çš„è¯­è¨€é£æ ¼æ¸©æš–ã€ä¸“ä¸šä¸”å¹½é»˜ï¼Œå–„äºä½¿ç”¨æ¯”å–»ï¼ˆå¦‚ä¹°æˆ¿å®šé‡‘æ¯”å–»Callï¼Œè½¦é™©æ¯”å–»Putï¼‰ã€‚å›ç­”è¯·ä¿æŒç®€ç»ƒï¼ˆ100å­—ä»¥å†…ï¼‰ï¼Œé‡ç‚¹è§£é‡Šç”¨æˆ·å…³äº Call, Put, Sell Put, Risk Reversal ç­‰æ¦‚å¿µçš„ç–‘æƒ‘ã€‚è¯·ç”¨ä¸­æ–‡å›ç­”ã€‚",
                quiz: "ä½ æ˜¯ä¸€ä¸ªæœŸæƒè€ƒè¯•å‡ºé¢˜æœºã€‚è¯·æ ¹æ®'Risk Reversal'ç­–ç•¥ï¼ˆSell Put + Buy Callï¼‰ç”Ÿæˆä¸€é“å•é¡¹é€‰æ‹©é¢˜ã€‚é¢˜ç›®è¦è€ƒå¯Ÿç”¨æˆ·å¯¹'å¦‚æœè‚¡ä»·ä¸‹è·Œä¼šå‘ç”Ÿä»€ä¹ˆ'æˆ–è€…'å¦‚æœè‚¡ä»·å¤§æ¶¨ä¼šå‘ç”Ÿä»€ä¹ˆ'çš„ç†è§£ã€‚è¯·ç›´æ¥è¿”å› Markdown æ ¼å¼ï¼ŒåŒ…å«ï¼š\n1. **é¢˜ç›®**\n2. é€‰é¡¹ A, B, C\n3. **ç­”æ¡ˆä¸è§£æ**ï¼ˆé»˜è®¤æŠ˜å æˆ–åœ¨æœ€åæ˜¾ç¤ºï¼‰ã€‚ä¸è¦ä½¿ç”¨ JSONã€‚è¯·ç”¨ä¸­æ–‡å‡ºé¢˜ã€‚"
            },
            en: {
                tutor: "You are a professional financial options tutor named 'Gemini', teaching a 'Zero to Hero Options' course. Your style is warm, professional, and humorous, using metaphors (e.g., House Deposit for Call, Car Insurance for Put). Keep answers concise (under 100 words). Explain Call, Put, Sell Put, Risk Reversal concepts clearly. Please answer in English.",
                quiz: "You are an options exam generator. Generate a multiple-choice question based on the 'Risk Reversal' strategy (Sell Put + Buy Call). Test the user's understanding of what happens if the stock crashes or rallies. Return strictly Markdown format containing: \n1. **Question**\n2. Options A, B, C\n3. **Answer & Explanation** (Hidden or at the end). Do not use JSON. Please generate in English."
            },
            ja: {
                tutor: "ã‚ãªãŸã¯ã€Œã‚¼ãƒ­ã‹ã‚‰å§‹ã‚ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³å–å¼•ã€ã‚³ãƒ¼ã‚¹ã‚’æ•™ãˆã‚‹ãƒ—ãƒ­ã®é‡‘èã‚ªãƒ—ã‚·ãƒ§ãƒ³è¬›å¸« 'Gemini' ã§ã™ã€‚ã‚¹ã‚¿ã‚¤ãƒ«ã¯æ¸©ã‹ãã€å°‚é–€çš„ã§ã€ãƒ¦ãƒ¼ãƒ¢ãƒ©ã‚¹ã«ï¼ˆä¾‹ï¼šCallã¯å®¶ã®æ‰‹ä»˜é‡‘ã€Putã¯è‡ªå‹•è»Šä¿é™ºï¼‰ã€‚å›ç­”ã¯ç°¡æ½”ã«ï¼ˆ200æ–‡å­—ä»¥å†…ï¼‰ã€‚Callã€Putã€Sell Putã€Risk Reversalã®æ¦‚å¿µã‚’æ˜ç¢ºã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚æ—¥æœ¬èªã§å›ç­”ã—ã¦ãã ã•ã„ã€‚",
                quiz: "ã‚ãªãŸã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³å–å¼•ã®è©¦é¨“ä½œæˆæ©Ÿã§ã™ã€‚ã€ŒRisk Reversalã€æˆ¦ç•¥ï¼ˆSell Put + Buy Callï¼‰ã«åŸºã¥ã„ã¦å¤šè‚¢é¸æŠå•é¡Œã‚’1ã¤ä½œæˆã—ã¦ãã ã•ã„ã€‚æ ªä¾¡ãŒæš´è½ã¾ãŸã¯é«˜é¨°ã—ãŸå ´åˆã«ä½•ãŒèµ·ã“ã‚‹ã‹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚JSONã¯ä½¿ç”¨ã›ãšã€ä»¥ä¸‹ã®Markdownå½¢å¼ã§è¿”ã—ã¦ãã ã•ã„ï¼š\n1. **å•é¡Œ**\n2. é¸æŠè‚¢ A, B, C\n3. **æ­£è§£ã¨è§£èª¬**ï¼ˆæŠ˜ã‚ŠãŸãŸã‚€ã‹æœ€å¾Œã«è¡¨ç¤ºï¼‰ã€‚æ—¥æœ¬èªã§ä½œæˆã—ã¦ãã ã•ã„ã€‚"
            }
        };

        async function callGemini(prompt, systemInstruction = "") {
            // RETRIEVE KEY FROM STORAGE
            const apiKey = localStorage.getItem('gemini_api_key');
            
            if (!apiKey) {
                openSettings();
                return currentLang === 'zh' ? "è¯·å…ˆç‚¹å‡»å³ä¸Šè§’è®¾ç½®å›¾æ ‡ï¼Œé…ç½®æ‚¨çš„ Gemini API Keyã€‚" : "Please set your Gemini API Key in Settings first.";
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemInstruction }] }
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    if (response.status === 400 || response.status === 403) {
                         throw new Error("Invalid API Key");
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || (currentLang === 'zh' ? "æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ— æ³•å›ç­”ï¼Œè¯·ç¨åå†è¯•ã€‚" : "Sorry, I cannot answer right now.");
            } catch (error) {
                console.error("Gemini API Error:", error);
                if (error.message === "Invalid API Key") {
                     return currentLang === 'zh' ? "API Key æ— æ•ˆï¼Œè¯·æ£€æŸ¥è®¾ç½®ã€‚" : "Invalid API Key. Please check settings.";
                }
                return currentLang === 'zh' ? "è¿æ¥ AI æœåŠ¡å‡ºé”™ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ– API Keyã€‚" : "Connection error. Please check API Key.";
            }
        }

        // --- LANGUAGE SWITCHING LOGIC ---
        const languageSelector = document.getElementById('languageSelector');
        
        // Store chart instances globally to update them
        const charts = {};

        function updateLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];

            // 1. Update Text Content
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) {
                    el.innerHTML = t[key]; // Use innerHTML to support bold tags
                }
            });

            // 2. Update Placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (t[key]) el.placeholder = t[key];
            });

            // 3. Update Static Quiz Content
            const staticQText = document.getElementById('staticQText');
            const staticQOptions = document.getElementById('staticQOptions');
            const staticQCorrect = document.getElementById('staticQCorrect');
            const staticQExplain = document.getElementById('staticQExplain');

            if (staticQText) staticQText.textContent = t.staticQText;
            if (staticQCorrect) staticQCorrect.textContent = t.staticQCorrect;
            if (staticQExplain) staticQExplain.textContent = t.staticQExplain;

            if (staticQOptions) {
                staticQOptions.innerHTML = '';
                t.staticQOptions.forEach(opt => {
                    const li = document.createElement('li');
                    li.className = 'bg-white/10 p-3 rounded option-btn cursor-pointer';
                    li.textContent = opt;
                    staticQOptions.appendChild(li);
                });
            }


            // 4. Update Charts
            if (charts.calories) {
                charts.calories.data.datasets[0].label = t.chartCaloriesLabel;
                charts.calories.options.plugins.title.text = splitLabel(t.chartCaloriesTitle);
                charts.calories.update();
            }
            if (charts.call) {
                charts.call.data.datasets[0].label = t.chartCallLabel;
                charts.call.options.plugins.title.text = splitLabel(t.chartCallTitle);
                charts.call.update();
            }
            if (charts.put) {
                charts.put.data.datasets[0].label = t.chartPutLabels[0]; // No Insurance
                charts.put.data.datasets[1].label = t.chartPutLabels[1]; // With Insurance
                charts.put.options.plugins.title.text = splitLabel(t.chartPutTitle);
                charts.put.options.scales.y.title.text = t.chartPutLabel; // Axis Label
                charts.put.update();
            }
            if (charts.sellPut) {
                charts.sellPut.data.labels = t.chartSellPutLabels.map(l => splitLabel(l));
                charts.sellPut.data.datasets[0].label = t.chartSellPutLabel;
                charts.sellPut.options.plugins.title.text = splitLabel(t.chartSellPutTitle);
                charts.sellPut.update();
            }
            if (charts.rr) {
                charts.rr.data.datasets[0].label = t.chartRRLabel;
                charts.rr.data.datasets[1].label = t.chartRRStockLabel;
                charts.rr.options.plugins.title.text = splitLabel(t.chartRRTitle);
                charts.rr.update();
            }
        }

        languageSelector.addEventListener('change', (e) => {
            updateLanguage(e.target.value);
        });

        // --- CHAT WIDGET LOGIC ---
        const toggleChatBtn = document.getElementById('toggleChatBtn');
        const closeChatBtn = document.getElementById('closeChatBtn');
        const chatWindow = document.getElementById('chatWindow');
        const chatForm = document.getElementById('chatForm');
        const userQuery = document.getElementById('userQuery');
        const chatMessages = document.getElementById('chatMessages');

        function toggleChat() {
            chatWindow.classList.toggle('hidden');
        }

        function appendMessage(text, isUser) {
            const div = document.createElement('div');
            div.className = `flex gap-2 ${isUser ? 'justify-end' : ''}`;
            
            const bubble = document.createElement('div');
            bubble.className = `p-3 rounded-lg max-w-[85%] text-sm ${isUser ? 'bg-pink-500 text-white rounded-tr-none' : 'bg-indigo-100 text-indigo-800 rounded-tl-none prose'}`;
            
            if (isUser) {
                bubble.textContent = text;
            } else {
                bubble.innerHTML = marked.parse(text);
            }
            
            div.appendChild(bubble);
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        toggleChatBtn.addEventListener('click', toggleChat);
        closeChatBtn.addEventListener('click', toggleChat);

        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const query = userQuery.value.trim();
            if (!query) return;

            // User Message
            appendMessage(query, true);
            userQuery.value = '';

            // Check if key is set BEFORE showing loading state
            if (!localStorage.getItem('gemini_api_key')) {
                openSettings();
                appendMessage("è¯·å…ˆåœ¨è®¾ç½®ä¸­é…ç½® Gemini API Keyã€‚", false);
                return;
            }

            // Loading state
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'flex gap-2';
            loadingDiv.innerHTML = `<div class="bg-gray-200 text-gray-500 p-3 rounded-lg rounded-tl-none text-xs animate-pulse">AI...</div>`;
            chatMessages.appendChild(loadingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // API Call with Language-Specific System Prompt
            const responseText = await callGemini(query, systemPrompts[currentLang].tutor);
            
            // Remove loading and show response
            chatMessages.removeChild(loadingDiv);
            appendMessage(responseText, false);
        });

        // --- STATIC QUIZ LOGIC ---
        const toggleAnswerBtn = document.getElementById('toggleAnswerBtn');
        const staticAnswerContainer = document.getElementById('staticAnswerContainer');
        
        toggleAnswerBtn.addEventListener('click', () => {
             staticAnswerContainer.classList.toggle('hidden');
        });


        // --- DYNAMIC QUIZ GENERATOR LOGIC ---
        const generateQuizBtn = document.getElementById('generateQuizBtn');
        const dynamicQuizContainer = document.getElementById('dynamicQuizContainer');

        generateQuizBtn.addEventListener('click', async () => {
             // Check if key is set first
            if (!localStorage.getItem('gemini_api_key')) {
                openSettings();
                alert(currentLang === 'zh' ? "è¯·å…ˆé…ç½® API Key / Please set API Key" : "Please set API Key");
                return;
            }

            dynamicQuizContainer.classList.remove('hidden');
            const t = translations[currentLang];
            dynamicQuizContainer.innerHTML = `
                <div class="animate-pulse flex space-x-4">
                    <div class="flex-1 space-y-4 py-1">
                        <div class="h-4 bg-white/20 rounded w-3/4"></div>
                        <div class="space-y-2">
                            <div class="h-4 bg-white/20 rounded"></div>
                            <div class="h-4 bg-white/20 rounded w-5/6"></div>
                        </div>
                    </div>
                </div>
                <p class="text-center text-sm text-indigo-300 mt-4">${t.quizLoading}</p>
            `;
            
            // Generate Quiz with Language-Specific Prompt
            const quizContent = await callGemini("Generate a Risk Reversal Quiz", systemPrompts[currentLang].quiz);
            
            dynamicQuizContainer.innerHTML = `
                <div class="prose prose-invert max-w-none text-white">
                    ${marked.parse(quizContent)}
                </div>
                <button onclick="document.getElementById('dynamicQuizContainer').classList.add('hidden')" class="mt-4 text-xs text-indigo-300 hover:text-white underline">âœ•</button>
            `;
        });

        // --- UTILITY: Label Splitting Logic (16 chars) ---
        function splitLabel(label) {
            if (label.length <= 16) return label;
            const words = label.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length <= 16) {
                    currentLine += " " + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // --- GLOBAL CHART OPTIONS ---
        Chart.defaults.font.family = "'Noto Sans SC', 'Noto Sans JP', 'Roboto', sans-serif";
        Chart.defaults.color = '#4B5563';
        
        const commonTooltip = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                        return label.join(' ');
                    } else {
                        return label;
                    }
                }
            }
        };

        const responsiveConfig = {
            maintainAspectRatio: false,
            responsive: true,
            plugins: {
                legend: { position: 'bottom' },
                tooltip: commonTooltip
            }
        };

        // --- CHART 1: CALORIES vs STOCK (Hook) ---
        const ctxCalories = document.getElementById('caloriesChart').getContext('2d');
        charts.calories = new Chart(ctxCalories, {
            type: 'bar',
            data: {
                labels: ['æ—¥å¸¸æ™šé¤å¡è·¯é‡Œ', 'æ„Ÿæ©èŠ‚æ™šé¤å¡è·¯é‡Œ'],
                datasets: [{
                    label: translations.zh.chartCaloriesLabel,
                    data: [800, 3000],
                    backgroundColor: ['#9CA3AF', '#EC4899'], // Gray vs Pink
                    borderRadius: 8
                }]
            },
            options: {
                ...responsiveConfig,
                plugins: {
                    ...responsiveConfig.plugins,
                    title: {
                        display: true,
                        text: splitLabel(translations.zh.chartCaloriesTitle)
                    }
                },
                scales: {
                    y: { beginAtZero: true, title: {display: true, text: 'Kcal'} }
                }
            }
        });

        // --- CHART 2: CALL OPTION PAYOFF (Line) ---
        // Scenario: Buy Call Strike $100, Premium $5.
        // Range: 80 to 150
        const callPrices = [80, 90, 100, 105, 120, 150];
        const callPayoff = callPrices.map(p => {
            // Profit = Max(Price - Strike, 0) - Premium
            return Math.max(p - 100, 0) - 5;
        });

        const ctxCall = document.getElementById('callPayoffChart').getContext('2d');
        charts.call = new Chart(ctxCall, {
            type: 'line',
            data: {
                labels: callPrices.map(p => `$${p}`),
                datasets: [{
                    label: translations.zh.chartCallLabel,
                    data: callPayoff,
                    borderColor: '#4F46E5', // Indigo
                    backgroundColor: 'rgba(79, 70, 229, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.1,
                    pointBackgroundColor: callPayoff.map(v => v >= 0 ? '#10B981' : '#EF4444'),
                    pointRadius: 5
                }]
            },
            options: {
                ...responsiveConfig,
                plugins: {
                    ...responsiveConfig.plugins,
                    title: { display: true, text: splitLabel(translations.zh.chartCallTitle) },
                    annotation: {
                        annotations: {
                            line1: {
                                type: 'line',
                                yMin: 0,
                                yMax: 0,
                                borderColor: 'black',
                                borderWidth: 1,
                                borderDash: [5, 5]
                            }
                        }
                    }
                }
            }
        });

        // --- CHART 3: PUT PROTECTION (Line Chart - NEW) ---
        // Scenario: Stock crashes from $50 (Entry) to $0.
        // X Axis: Future Car Value (Stock Price) $0 -> $60
        // Line 1 (Unprotected): Value = x
        // Line 2 (Protected): Value = Max(x, 50) - 1 (Premium)
        // Range: 0, 10, 20, 30, 40, 50, 60
        const putPrices = [0, 10, 20, 30, 40, 50, 60];
        const unProtectedValue = putPrices; // Value = Price
        const protectedValue = putPrices.map(p => Math.max(p, 50) - 1); // Strike 50, Premium 1

        const ctxPut = document.getElementById('putProtectionChart').getContext('2d');
        charts.put = new Chart(ctxPut, {
            type: 'line',
            data: {
                labels: putPrices.map(p => `$${p}k`),
                datasets: [
                    {
                        label: translations.zh.chartPutLabels[0], // Unprotected
                        data: unProtectedValue,
                        borderColor: '#9CA3AF', // Gray
                        borderDash: [5, 5],
                        borderWidth: 2,
                        pointRadius: 0
                    },
                    {
                        label: translations.zh.chartPutLabels[1], // Protected
                        data: protectedValue,
                        borderColor: '#EC4899', // Pink
                        backgroundColor: 'rgba(236, 72, 153, 0.1)',
                        borderWidth: 3,
                        fill: true
                    }
                ]
            },
            options: {
                ...responsiveConfig,
                plugins: {
                    ...responsiveConfig.plugins,
                    title: { display: true, text: splitLabel(translations.zh.chartPutTitle) },
                    tooltip: {
                         callbacks: {
                            title: (tooltipItems) => `è½¦å€¼: ${tooltipItems[0].label}`,
                            label: (context) => `${context.dataset.label}: $${context.raw}k`
                        }
                    }
                },
                scales: {
                    y: { title: {display: true, text: 'èµ„äº§æ€»å€¼ ($k)'} },
                    x: { title: {display: true, text: 'æœªæ¥è½¦ä»·/è‚¡ä»· ($k)'} }
                }
            }
        });

        // --- CHART 4: SELL PUT COST BASIS (Grouped Bar) ---
        // Scenario: Target Buy Price. Current $100.
        // Method A: Buy Now. Cost $100.
        // Method B: Sell Put Strike $90, Premium $2. Effective Cost if exercised = 90 - 2 = 88.
        const ctxSellPut = document.getElementById('sellPutChart').getContext('2d');
        charts.sellPut = new Chart(ctxSellPut, {
            type: 'bar',
            data: {
                labels: [splitLabel('ç›´æ¥ä¹°å…¥ç°ä»·è‚¡ç¥¨'), splitLabel('å–å‡º Put æ¥ç›˜')],
                datasets: [{
                    label: translations.zh.chartSellPutLabel,
                    data: [100, 88],
                    backgroundColor: ['#6B7280', '#06B6D4'], // Gray vs Cyan
                    barThickness: 50,
                    borderRadius: 4
                }]
            },
            options: {
                ...responsiveConfig,
                scales: {
                    y: { min: 80, title: {display: true, text: 'æ¯è‚¡æˆæœ¬ ($)'} }
                },
                plugins: {
                    ...responsiveConfig.plugins,
                    title: { display: true, text: splitLabel(translations.zh.chartSellPutTitle) }
                }
            }
        });

        // --- CHART 5: RISK REVERSAL PAYOFF vs LONG STOCK (Line) ---
        // Leg 1: Sell Put 97.5 (Receive 2)
        // Leg 2: Buy Call 115 (Pay 2)
        // Net Premium: 0
        // Comparison: Long Stock at Current Price ~103 (Mid point)
        
        const rrPrices2 = [80, 90, 97.5, 103, 110, 115, 125, 140];
        const entryPrice = 103;
        
        const rrPayoff2 = rrPrices2.map(p => {
            let val = 0;
            // Put Leg (Short 97.5) -> Obligation to buy at 97.5
            // If p < 97.5, we lose (97.5 - p) relative to cash, effectively owning stock at 97.5
            // Standard P/L diagram relative to strike: 
            // Short Put P/L = -(Max(97.5 - p, 0)) + 2
            // Long Call P/L = Max(p - 115, 0) - 2
            // Total RR P/L
            const putPL = -Math.max(97.5 - p, 0) + 2;
            const callPL = Math.max(p - 115, 0) - 2;
            return putPL + callPL;
        });

        const stockPayoff = rrPrices2.map(p => p - entryPrice); // Simple P/L: Price - Entry

        const ctxRR = document.getElementById('riskReversalChart').getContext('2d');
        charts.rr = new Chart(ctxRR, {
            type: 'line',
            data: {
                labels: rrPrices2.map(p => `$${p}`),
                datasets: [
                    {
                        label: translations.zh.chartRRLabel,
                        data: rrPayoff2,
                        borderColor: '#8B5CF6', // Violet
                        borderWidth: 3,
                        fill: false, // Don't fill for cleaner comparison
                        tension: 0.2,
                        pointBackgroundColor: '#FFFFFF',
                        pointBorderColor: '#8B5CF6',
                        pointRadius: 6,
                        order: 1
                    },
                    {
                        label: translations.zh.chartRRStockLabel,
                        data: stockPayoff,
                        borderColor: '#9CA3AF', // Gray
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        tension: 0,
                        order: 2
                    }
                ]
            },
            options: {
                ...responsiveConfig,
                plugins: {
                    ...responsiveConfig.plugins,
                    title: { display: true, text: splitLabel(translations.zh.chartRRTitle) },
                    annotation: {
                        annotations: {
                            lineZero: {
                                type: 'line',
                                yMin: 0,
                                yMax: 0,
                                borderColor: 'gray',
                                borderWidth: 1
                            }
                        }
                    }
                },
                scales: {
                    y: { title: {display: true, text: 'ç›ˆäº ($)'} }
                }
            }
        });
        
        // Initialize with default language to populate static quiz
        updateLanguage('zh');

    </script>
</body>
</html>